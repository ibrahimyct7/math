<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neural Hub</title>
    
    <style>
        :root {
            --bg: #142616;
            --panel: #1e3622;
            --cream: #f1f8e9;
            --mint: #c8e6c9;
            --btn-dark: #0c1a0e;
            
            /* Portal Colors */
            --c-math: #81c784;
            --c-word: #64b5f6;
            --c-color: #e57373;
            --c-seq: #ffd54f;
            
            /* Diff Colors */
            --easy: #a5d6a7;
            --hard: #ffb74d;
            --god: #ef5350;
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 20px 20px;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; color: var(--cream);
            overflow: hidden; touch-action: manipulation;
        }

        #app {
            background: var(--panel);
            padding: 2rem 1rem;
            border-radius: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            text-align: center;
            width: 92%; max-width: 380px;
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            transition: transform 0.3s ease;
        }

        .view-section { width: 100%; display: flex; flex-direction: column; align-items: center; }
        .hidden { display: none !important; }

        /* Portal Button Styling */
        .portal-item {
            display: flex; align-items: center; justify-content: space-between;
            width: 100%; background: var(--btn-dark);
            border-radius: 25px; padding: 10px 15px; margin-bottom: 12px;
            border: 1px solid rgba(255,255,255,0.05);
            box-sizing: border-box;
        }

        .btn-main {
            flex-grow: 1; padding: 15px; border: none; border-radius: 18px;
            font-weight: 800; font-size: 1rem; cursor: pointer;
            text-align: left; transition: 0.2s;
        }

        /* Progress Circle */
        .progress-box {
            position: relative; width: 50px; height: 50px;
            display: flex; align-items: center; justify-content: center;
            margin-left: 10px;
        }
        .progress-svg { transform: rotate(-90deg); width: 50px; height: 50px; }
        .progress-bg { fill: none; stroke: rgba(255,255,255,0.1); stroke-width: 4; }
        .progress-bar { fill: none; stroke-width: 4; stroke-linecap: round; transition: stroke-dashoffset 1s ease; }
        .progress-text { position: absolute; font-size: 0.65rem; font-weight: bold; color: var(--mint); }

        /* Game UI */
        #question-text { font-size: 3rem; margin: 15px 0; font-weight: 900; min-height: 120px; display: flex; align-items: center; justify-content: center; text-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .v-list { display: flex; flex-direction: column; gap: 10px; width: 100%; }
        
        button { cursor: pointer; font-family: inherit; }
        .btn-choice {
            padding: 16px; border: none; border-radius: 20px;
            background: var(--btn-dark); color: var(--cream);
            font-weight: 700; font-size: 1.2rem; border: 1px solid rgba(255,255,255,0.1);
        }

        input[type="text"] {
            width: 100%; max-width: 100%; box-sizing: border-box;
            padding: 18px; border-radius: 20px; border: 2px solid var(--mint);
            background: var(--btn-dark); color: white; font-size: 1.4rem;
            text-align: center; font-weight: bold; outline: none; margin-bottom: 10px;
        }

        /* Status colors */
        .flash-correct { background-color: #2e7d32 !important; }
        .flash-wrong { background-color: #8b0000 !important; }
        .shake { animation: shake 0.4s ease; }
        @keyframes shake { 0%, 100% {transform:translateX(0)} 25% {transform:translateX(-10px)} 75% {transform:translateX(10px)} }

        #timer-container { width: 100%; height: 6px; background: rgba(0,0,0,0.2); border-radius: 10px; margin-bottom: 20px; overflow: hidden; display: none; }
        #timer-bar { height: 100%; background: var(--mint); width: 100%; }

        .btn-back { background: transparent; color: var(--mint); opacity: 0.6; border: 1px solid rgba(255,255,255,0.1); padding: 10px; margin-top: 15px; font-size: 0.8rem; border-radius: 12px; }
    </style>
</head>
<body>

<div id="app">
    <div id="timer-container"><div id="timer-bar"></div></div>

    <div id="view-hub" class="view-section">
        <h1 style="color:var(--mint); margin-bottom:5px;">Neural Hub</h1>
        <p style="opacity:0.6; margin-bottom:20px; font-size:0.9rem;">Work your brain daily.</p>
        
        <div class="v-list" id="portal-list">
            <div class="portal-item">
                <button class="btn-main" style="background:var(--c-math); color:#1b3320;" onclick="showPortal('math')">MATH</button>
                <div class="progress-box" id="prog-math"></div>
            </div>
            <div class="portal-item">
                <button class="btn-main" style="background:var(--c-word); color:#0d1b2a;" onclick="showPortal('word')">WORDS</button>
                <div class="progress-box" id="prog-word"></div>
            </div>
            <div class="portal-item">
                <button class="btn-main" style="background:var(--c-color); color:#2d0a0a;" onclick="showPortal('color')">COLOR CLASH</button>
                <div class="progress-box" id="prog-color"></div>
            </div>
            <div class="portal-item">
                <button class="btn-main" style="background:var(--c-seq); color:#2d240a;" onclick="showPortal('seq')">RECALL</button>
                <div class="progress-box" id="prog-seq"></div>
            </div>
        </div>
    </div>

    <div id="view-options" class="view-section hidden">
        <h1 id="opt-title">Options</h1>
        <div id="type-list" class="v-list" style="margin-top:20px;">
            <button class="btn-choice" onclick="setOpt('type', 'zen')">ZEN (No Timer)</button>
            <button class="btn-choice" style="background:#4e342e" onclick="setOpt('type', 'blitz')">BLITZ (Timed)</button>
        </div>
        <div id="diff-list" class="v-list hidden" style="margin-top:20px;">
            <button class="btn-choice" style="color:var(--easy)" onclick="startGame('easy')">EASY</button>
            <button class="btn-choice" style="color:var(--hard)" onclick="startGame('hard')">HARD</button>
            <button class="btn-choice" style="color:var(--god)" onclick="startGame('god')">GOD MODE</button>
        </div>
        <button class="btn-back" onclick="resetToHub()">‚Üê BACK</button>
    </div>

    <div id="view-game" class="view-section hidden">
        <div id="question-text">--</div>
        <div id="input-area" class="v-list">
            <div id="choices-area" class="v-list"></div>
            <div id="text-area" class="hidden">
                <input type="text" id="answer-input" placeholder="Type answer..." autocomplete="off">
                <button class="btn-choice" style="background:var(--primary-green)" onclick="checkText()">SUBMIT</button>
            </div>
        </div>
        <button class="btn-back" onclick="resetToHub()">QUIT</button>
    </div>

    <div id="view-results" class="view-section hidden">
        <h1>Finished</h1>
        <p style="font-size: 4rem; margin: 10px 0;"><span id="res-score">0</span>/10</p>
        <button class="btn-choice" style="width:100%" onclick="resetToHub()">CONTINUE</button>
    </div>
</div>

<script>
    let curPortal = '', curType = '', curDiff = '';
    let curScore = 0, qNum = 0, correctAns = '', timerInt;
    
    const colors = ["RED", "BLUE", "GREEN", "YELLOW", "ORANGE", "PINK", "WHITE"];
    const hex = ["#ff5252", "#448aff", "#4caf50", "#ffeb3b", "#ff9800", "#e91e63", "#ffffff"];
    const simpleWords = ["HOUSE", "APPLE", "WATER", "BREAD", "SMILE", "CLOCK", "TRAIN", "CLOUD", "DOOR", "PAPER"];

    function resetToHub() {
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-hub').classList.remove('hidden');
        document.getElementById('app').className = '';
        document.getElementById('timer-container').style.display = 'none';
        clearInterval(timerInt);
        drawProgress();
    }

    function showPortal(p) {
        curPortal = p;
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-options').classList.remove('hidden');
        document.getElementById('type-list').classList.remove('hidden');
        document.getElementById('diff-list').classList.add('hidden');
    }

    function setOpt(key, val) {
        if(key === 'type') {
            curType = val;
            document.getElementById('type-list').classList.add('hidden');
            document.getElementById('diff-list').classList.remove('hidden');
        }
    }

    function startGame(d) {
        curDiff = d; curScore = 0; qNum = 1;
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-game').classList.remove('hidden');
        nextQuestion();
    }

    function nextQuestion() {
        if(qNum > 10) return endRound();
        document.getElementById('app').className = '';
        document.getElementById('text-area').classList.add('hidden');
        document.getElementById('choices-area').classList.remove('hidden');
        document.getElementById('choices-area').innerHTML = '';
        
        if(curPortal === 'math') genMath();
        if(curPortal === 'word') genWord();
        if(curPortal === 'color') genColor();
        if(curPortal === 'seq') genSeq();

        if(curType === 'blitz') startTimer();
    }

    // --- GAME GENERATORS ---

    function genMath() {
        let r = curDiff === 'god' ? 500 : 100;
        let n1 = Math.floor(Math.random()*r), n2 = Math.floor(Math.random()*r);
        correctAns = n1 + n2;
        document.getElementById('question-text').innerText = `${n1} + ${n2}`;
        makeChoices(correctAns, 'num');
    }

    function genWord() {
        document.getElementById('text-area').classList.remove('hidden');
        document.getElementById('choices-area').classList.add('hidden');
        let w = simpleWords[Math.floor(Math.random()*simpleWords.length)];
        correctAns = w;
        let s = w.split('').sort(()=>Math.random()-0.5).join('');
        document.getElementById('question-text').innerText = s;
        document.getElementById('answer-input').focus();
    }

    function genColor() {
        let wordIdx = Math.floor(Math.random()*colors.length);
        let colorIdx = Math.floor(Math.random()*colors.length);
        correctAns = hex[colorIdx];
        let q = document.getElementById('question-text');
        q.innerText = colors[wordIdx];
        q.style.color = hex[colorIdx];
        
        // Show hex color choices as colored boxes
        let set = new Set([colorIdx]);
        while(set.size < 4) set.add(Math.floor(Math.random()*colors.length));
        Array.from(set).sort(()=>Math.random()-0.5).forEach(i => {
            const b = document.createElement('button');
            b.className = 'btn-choice';
            b.style.backgroundColor = hex[i];
            b.innerHTML = "&nbsp;";
            b.onclick = () => check(hex[i]);
            document.getElementById('choices-area').appendChild(b);
        });
    }

    function genSeq() {
        let seq = [];
        let len = curDiff === 'god' ? 6 : (curDiff === 'hard' ? 4 : 3);
        for(let i=0; i<len; i++) seq.push(Math.floor(Math.random()*9));
        
        document.getElementById('question-text').innerText = seq.join(' ');
        document.getElementById('choices-area').classList.add('hidden');
        
        setTimeout(() => {
            document.getElementById('question-text').innerText = "?";
            document.getElementById('choices-area').classList.remove('hidden');
            correctAns = seq[Math.floor(Math.random()*len)];
            document.getElementById('question-text').innerText = "Find: " + correctAns;
            makeChoices(correctAns, 'num');
        }, 1500);
    }

    // --- LOGIC ---

    function makeChoices(c, mode) {
        let s = new Set([c]);
        while(s.size < 4) s.add(mode === 'num' ? c + (Math.floor(Math.random()*10)-5) : simpleWords[Math.floor(Math.random()*10)]);
        Array.from(s).sort(()=>Math.random()-0.5).forEach(v => {
            const b = document.createElement('button');
            b.className = 'btn-choice'; b.innerText = v;
            b.onclick = () => check(v);
            document.getElementById('choices-area').appendChild(b);
        });
    }

    function checkText() { check(document.getElementById('answer-input').value.toUpperCase().trim()); }

    function check(v) {
        clearInterval(timerInt);
        const app = document.getElementById('app');
        if(v == correctAns) {
            curScore++;
            app.classList.add('flash-correct');
        } else {
            app.classList.add('flash-wrong', 'shake');
        }
        qNum++;
        setTimeout(nextQuestion, 1000);
    }

    function startTimer() {
        let t = curDiff === 'god' ? 3 : 7;
        let left = t;
        document.getElementById('timer-container').style.display = 'block';
        timerInt = setInterval(() => {
            left -= 0.1;
            document.getElementById('timer-bar').style.width = (left/t)*100 + "%";
            if(left <= 0) { clearInterval(timerInt); check('MISS'); }
        }, 100);
    }

    function endRound() {
        document.getElementById('view-game').classList.add('hidden');
        document.getElementById('view-results').classList.remove('hidden');
        document.getElementById('res-score').innerText = curScore;
        saveProgress(curPortal, curScore);
    }

    function saveProgress(p, score) {
        let data = JSON.parse(localStorage.getItem('neural_stats') || '{}');
        if(!data[p]) data[p] = { total: 0, correct: 0 };
        data[p].total += 10;
        data[p].correct += score;
        localStorage.setItem('neural_stats', JSON.stringify(data));
    }

    function drawProgress() {
        const stats = JSON.parse(localStorage.getItem('neural_stats') || '{}');
        const portals = ['math', 'word', 'color', 'seq'];
        
        portals.forEach(p => {
            const container = document.getElementById('prog-' + p);
            let percent = 0;
            if(stats[p]) percent = Math.round((stats[p].correct / stats[p].total) * 100);
            
            const dash = (percent / 100) * 126; // Circumference of circle (r=20) is ~126
            container.innerHTML = `
                <svg class="progress-svg">
                    <circle class="progress-bg" cx="25" cy="25" r="20"></circle>
                    <circle class="progress-bar" cx="25" cy="25" r="20" 
                        style="stroke: var(--c-${p}); stroke-dasharray: 126; stroke-dashoffset: ${126 - dash};"></circle>
                </svg>
                <div class="progress-text">${percent}%</div>
            `;
        });
    }

    drawProgress();
</script>
</body>
</html>
