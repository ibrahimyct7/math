<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neural Hub | Cozy Forest</title>
    
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">

    <style>
        :root {
            /* Lighter, Warmer Forest Colors */
            --bg-forest: #142616;
            --panel-cozy: #1e3622;
            --accent-mint: #c8e6c9;
            --cream: #f1f8e9;
            --primary-green: #4caf50;
            
            /* Difficulty Colors */
            --easy-color: #81c784;
            --hard-color: #ffb74d;
            --god-color: #e57373;
            
            --button-dark: #0c1a0e;
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-forest);
            /* Soft Forest Pattern */
            background-image: radial-gradient(rgba(255,255,255,0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; color: var(--cream);
            overflow: hidden; -webkit-tap-highlight-color: transparent;
        }

        #app {
            background: var(--panel-cozy);
            padding: 2.2rem 1.2rem;
            border-radius: 40px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
            text-align: center;
            width: 90%; max-width: 380px;
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
            transition: all 0.4s ease;
        }

        /* Feedback Flashes */
        .flash-right { background-color: #2e7d32 !important; transform: scale(1.02); }
        .flash-wrong { background-color: #6a1b1b !important; }

        .view-section { width: 100%; display: flex; flex-direction: column; align-items: center; }
        .hidden { display: none !important; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        .shake { animation: shake 0.3s ease-in-out; }

        .app-logo { width: 65px; height: 65px; border-radius: 20px; margin-bottom: 15px; border: 2px solid var(--primary-green); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }

        #timer-container {
            width: 100%; height: 8px; background: rgba(0,0,0,0.2); 
            border-radius: 10px; margin-bottom: 20px; overflow: hidden; display: none;
        }
        #timer-bar { height: 100%; background: var(--primary-green); width: 100%; }

        h1 { margin: 0; color: var(--accent-mint); font-size: 1.8rem; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        p { color: var(--accent-mint); opacity: 0.8; margin-bottom: 20px; font-size: 0.9rem; }

        .v-list { display: flex; flex-direction: column; gap: 12px; width: 100%; }

        button {
            padding: 18px; border: none; border-radius: 20px;
            font-weight: 700; cursor: pointer; transition: 0.2s;
            font-size: 1rem; width: 100%;
            background: var(--button-dark); color: var(--accent-mint);
            border: 1px solid rgba(255,255,255,0.05);
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        button:active { transform: translateY(3px); box-shadow: none; }

        /* Level Specific Buttons */
        .btn-easy { background: var(--easy-color) !important; color: #1b3320 !important; }
        .btn-hard { background: var(--hard-color) !important; color: #3e2723 !important; }
        .btn-god { background: var(--god-color) !important; color: #ffffff !important; }

        input[type="text"] {
            width: 100%; padding: 20px; border-radius: 20px; border: 2px solid var(--primary-green);
            background: var(--button-dark); color: var(--white); font-size: 1.6rem;
            text-align: center; font-weight: bold; outline: none; margin-bottom: 12px;
        }

        .btn-portal { background: var(--primary-green); color: white; font-size: 1.1rem; }
        .btn-secondary { background: transparent; color: var(--accent-mint); opacity: 0.6; font-size: 0.8rem; border: 1px solid rgba(255,255,255,0.1); margin-top: 15px; box-shadow: none; }

        #question-text { font-size: 3.5rem; margin: 10px 0; font-weight: 900; min-height: 130px; display: flex; align-items: center; justify-content: center; color: var(--cream); }
        #feedback-area { font-size: 1.1rem; font-weight: bold; height: 35px; color: #ffd54f; margin-bottom: 5px; }
        .stat-row { width: 100%; display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--accent-mint); margin-bottom: 10px; font-weight: bold; }
    </style>
</head>
<body>

<div id="app">
    <div id="timer-container"><div id="timer-bar"></div></div>

    <div id="view-hub" class="view-section">
        <img src="logo.png" class="app-logo" onerror="this.style.display='none'">
        <h1>Neural Hub</h1>
        <p>Your Brain's Cozy Gym</p>
        <div class="v-list">
            <button class="btn-portal" onclick="showPortal('math')">üî¢ NUMBER LAB</button>
            <button class="btn-portal" onclick="showPortal('word')">üî† WORD GARDEN</button>
            <button class="btn-portal" onclick="showPortal('logic')">üß© PATTERN PATH</button>
        </div>
    </div>

    <div id="view-portal-menu" class="view-section hidden">
        <h1 id="portal-title">Exercise</h1>
        <p>Which path will you take?</p>
        <div id="op-list" class="v-list"></div>
        <button class="btn-secondary" onclick="resetToHub()">‚Üê BACK TO HUB</button>
    </div>

    <div id="view-type" class="view-section hidden">
        <h1>Select Pace</h1>
        <p>Calm or Fast?</p>
        <div class="v-list">
            <button class="btn-easy" onclick="pickType('zen')">ZEN (No Timer)</button>
            <button class="btn-hard" onclick="pickType('blitz')">BLITZ (Timed)</button>
            <button class="btn-secondary" onclick="showPortal(currentPortal)">‚Üê BACK</button>
        </div>
    </div>

    <div id="view-diff" class="view-section hidden">
        <h1>Set Intensity</h1>
        <div class="v-list">
            <button class="btn-easy" onclick="startGame('easy')">SPROUT (Easy)</button>
            <button class="btn-hard" onclick="startGame('hard')">TIMBER (Hard)</button>
            <button class="btn-god" onclick="startGame('god')">OVERGROWTH (God)</button>
            <button class="btn-secondary" onclick="pickType(selectedType)">‚Üê BACK</button>
        </div>
    </div>

    <div id="view-game" class="view-section hidden">
        <div class="stat-row">
            <span>Q: <span id="q-count">1</span>/10</span>
            <span id="score-count">SCORE: 0</span>
        </div>
        <div id="question-text">--</div>
        <div id="feedback-area"></div>
        
        <div id="input-container" class="v-list">
            <div id="choices-area" class="v-list"></div>
            <div id="text-area" class="hidden">
                <input type="text" id="answer-input" placeholder="Type here..." autocomplete="off">
                <button class="btn-portal" onclick="submitTextAnswer()">SUBMIT</button>
            </div>
        </div>
        <button class="btn-secondary" onclick="resetToHub()">QUIT GAME</button>
    </div>

    <div id="view-results" class="view-section hidden">
        <h1>Great Work!</h1>
        <p style="font-size: 4rem; margin: 15px 0;"><span id="final-score">0</span>/10</p>
        <button class="btn-portal" onclick="resetToHub()">RETURN HOME</button>
    </div>
</div>

<script>
    let currentPortal = '', selectedOp = '', selectedType = '', selectedDiff = '';
    let currentScore = 0, questionNumber = 0, correctAnswer = '', timerInterval, timeLeft, maxTime;

    // SIMPLE, RECOGNIZABLE WORDS
    const simpleWords = [
        "APPLE", "HOUSE", "WATER", "GRASS", "BREAD", "CHAIR", "TABLE", "STORM", "HAPPY", "LIGHT", 
        "PHONE", "WATCH", "CLOCK", "PAPER", "NIGHT", "BOOKS", "SMILE", "RIVER", "TRAIN", "PLANE",
        "STREET", "FLOWER", "GARDEN", "SCHOOL", "FRIEND", "COFFEE", "MUSIC", "PIZZA", "SHIRT", "SHOES",
        "DOLLAR", "OCEAN", "WINDOW", "DOOR", "FLOOR", "CLOUD", "BIRDY", "MOUSE", "HORSE", "CANDY",
        "TRUCK", "SPOON", "PLATE", "JUICE", "EARTH", "WORLD", "HEART", "DANCE", "CLEAN", "SLEEP",
        "GREEN", "WHITE", "BLACK", "SMALL", "LARGE", "CHILD", "PARTY", "MOVIE", "LUNCH", "SUGAR"
    ];

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(f, t, d) {
        const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
        o.connect(g); g.connect(audioCtx.destination); o.type = t; o.frequency.value = f;
        g.gain.setValueAtTime(0.05, audioCtx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + d);
        o.start(); o.stop(audioCtx.currentTime + d);
    }

    function resetToHub() {
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-hub').classList.remove('hidden');
        document.getElementById('app').className = '';
        document.getElementById('timer-container').style.display = 'none';
        clearInterval(timerInterval);
    }

    function showPortal(p) {
        currentPortal = p;
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-portal-menu').classList.remove('hidden');
        const list = document.getElementById('op-list'); list.innerHTML = '';
        const ops = p === 'math' ? ["Addition +", "Subtraction -", "Times √ó", "Mixed ¬±√ó"] : p === 'word' ? ["Scramble", "Missing"] : ["Patterns"];
        ops.forEach(o => {
            const b = document.createElement('button'); b.innerText = o.toUpperCase();
            b.onclick = () => { selectedOp = o; showType(); }; list.appendChild(b);
        });
    }

    function showType() {
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-type').classList.remove('hidden');
    }

    function pickType(t) {
        selectedType = t;
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-diff').classList.remove('hidden');
    }

    function startGame(d) {
        selectedDiff = d; currentScore = 0; questionNumber = 1;
        maxTime = d === 'god' ? 4 : d === 'hard' ? 8 : 15;
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-game').classList.remove('hidden');
        if(selectedType === 'blitz') document.getElementById('timer-container').style.display = 'block';
        nextQuestion();
    }

    function nextQuestion() {
        if (questionNumber > 10) return showResults();
        document.getElementById('app').className = '';
        document.getElementById('feedback-area').innerText = '';
        document.getElementById('q-count').innerText = questionNumber;
        document.getElementById('score-count').innerText = `SCORE: ${currentScore}`;
        document.getElementById('answer-input').value = '';
        document.getElementById('text-area').classList.add('hidden');
        document.getElementById('choices-area').classList.remove('hidden');

        if (currentPortal === 'math') generateMath();
        else if (currentPortal === 'word') generateWord();
        else generateLogic();

        if (selectedType === 'blitz') startTimer();
    }

    function generateMath() {
        let range = selectedDiff === 'god' ? 500 : 100;
        let op = selectedOp.toLowerCase(); if(op.includes('mixed')) op = ['add','sub','mul'][Math.floor(Math.random()*3)];
        let n1, n2, sym;
        if(op.includes('add')){ n1=rand(range); n2=rand(range); correctAnswer = n1+n2; sym='+'; }
        else if(op.includes('sub')){ n1=rand(range)+10; n2=rand(n1); correctAnswer = n1-n2; sym='-'; }
        else { n1=rand(selectedDiff==='god'?30:12)+1; n2=rand(12)+1; correctAnswer = n1*n2; sym='√ó'; }
        document.getElementById('question-text').innerText = `${n1} ${sym} ${n2}`;
        makeChoices(correctAnswer);
    }

    function generateWord() {
        document.getElementById('choices-area').classList.add('hidden');
        document.getElementById('text-area').classList.remove('hidden');
        let w = simpleWords[Math.floor(Math.random()*simpleWords.length)]; correctAnswer = w;
        if(selectedOp.includes('Scramble')) {
            let s = w.split('').sort(()=>Math.random()-0.5).join('');
            while(s === w) s = w.split('').sort(()=>Math.random()-0.5).join('');
            document.getElementById('question-text').innerText = s;
        } else {
            let i = Math.floor(Math.random()*w.length);
            let d = w.split(''); d[i] = '_';
            document.getElementById('question-text').innerText = d.join('');
        }
        document.getElementById('answer-input').focus();
    }

    function generateLogic() {
        let seq = [], r = rand(3), s = rand(10)+1;
        if(r === 0) { let st = rand(8)+2; for(let i=0; i<4; i++) seq.push(s+(st*i)); correctAnswer = s+(st*4); }
        else if(r === 1) { seq = [s, s+rand(3)+1]; for(let i=2; i<4; i++) seq.push(seq[i-1]+seq[i-2]); correctAnswer = seq[3]+seq[2]; }
        else { let st = rand(4)+1; for(let i=0; i<4; i++) seq.push((st+i)*(st+i)); correctAnswer = (st+4)*(st+4); }
        document.getElementById('question-text').style.fontSize = "2.5rem";
        document.getElementById('question-text').innerText = seq.join(', ') + ', ?';
        makeChoices(correctAnswer);
    }

    function makeChoices(c) {
        let s = new Set([c]);
        while(s.size < 4) { let f = c + (Math.floor(Math.random()*10)-5); if(f>=0 && f!=c) s.add(f); }
        const area = document.getElementById('choices-area'); area.innerHTML = '';
        Array.from(s).sort(()=>Math.random()-0.5).forEach(v => {
            const b = document.createElement('button'); b.className = 'btn-choice'; b.innerText = v;
            b.onclick = () => check(v, b); area.appendChild(b);
        });
    }

    function submitTextAnswer() { check(document.getElementById('answer-input').value.toUpperCase().trim()); }

    function check(v, btn) {
        clearInterval(timerInterval);
        document.querySelectorAll('.btn-choice').forEach(b => b.disabled = true);
        const app = document.getElementById('app');
        
        if(String(v) === String(correctAnswer)) {
            currentScore++; app.classList.add('flash-right');
            playSound(600, 'sine', 0.1);
            document.getElementById('feedback-area').innerText = "CORRECT!";
        } else {
            app.classList.add('flash-wrong', 'shake');
            playSound(120, 'square', 0.2);
            document.getElementById('feedback-area').innerText = "WRONG! IT WAS: " + correctAnswer;
        }
        questionNumber++; setTimeout(nextQuestion, 1600);
    }

    function startTimer() {
        clearInterval(timerInterval); timeLeft = maxTime;
        const bar = document.getElementById('timer-bar');
        timerInterval = setInterval(() => {
            timeLeft -= 0.05; bar.style.width = (timeLeft/maxTime)*100 + "%";
            if(timeLeft <= 0) { clearInterval(timerInterval); check('TIMEOUT'); }
        }, 50);
    }

    function showResults() {
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-results').classList.remove('hidden');
        document.getElementById('final-score').innerText = currentScore;
    }

    function rand(m) { return Math.floor(Math.random()*m); }
    document.getElementById('answer-input').addEventListener('keypress', (e) => { if(e.key === 'Enter') submitTextAnswer(); });
</script>
</body>
</html>
