<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neural Hub | Infinite Forest</title>
    
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="apple-touch-icon" href="logo.png">

    <style>
        :root {
            --bg-dark: #040d06;
            --panel-dark: #0a1f0f;
            --primary-green: #2e7d32;
            --accent-mint: #a5d6a7;
            --white: #e8f5e9;
            --error-red: #7f1d1d;
            --button-dark: #121212;
            --gold: #ffd740;
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-dark);
            background-image: radial-gradient(var(--panel-dark) 1.5px, transparent 1.5px);
            background-size: 25px 25px;
            display: flex; justify-content: center; align-items: center;
            min-height: 100vh; color: var(--white);
            overflow: hidden; -webkit-tap-highlight-color: transparent;
        }

        #app {
            background: var(--panel-dark);
            padding: 2.5rem 1.5rem;
            border-radius: 40px;
            box-shadow: 0 30px 80px rgba(0,0,0,0.8);
            text-align: center;
            width: 90%; max-width: 400px;
            border: 2px solid rgba(165, 214, 167, 0.1);
            position: relative;
            transition: background-color 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Feedback Flashes */
        .flash-right { background-color: #143a18 !important; }
        .flash-wrong { background-color: #4a0c0c !important; }

        .view-section { width: 100%; display: flex; flex-direction: column; align-items: center; }
        .hidden { display: none !important; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
        }
        .shake { animation: shake 0.4s ease-in-out; }

        .app-logo { width: 70px; height: 70px; border-radius: 20px; margin-bottom: 15px; border: 2px solid var(--primary-green); }

        #timer-container {
            width: 100%; height: 6px; background: rgba(255,255,255,0.05); 
            border-radius: 10px; margin-bottom: 25px; overflow: hidden; display: none;
        }
        #timer-bar { height: 100%; background: var(--primary-green); width: 100%; transition: width 0.1s linear; }

        h1 { margin: 0; color: var(--accent-mint); font-size: 1.8rem; letter-spacing: 1px; }
        p { color: var(--accent-mint); opacity: 0.6; margin-bottom: 20px; font-size: 0.9rem; }

        .v-list { display: flex; flex-direction: column; gap: 12px; width: 100%; }

        button {
            padding: 18px; border: none; border-radius: 22px;
            font-weight: 700; cursor: pointer; transition: 0.2s;
            font-size: 1.1rem; width: 100%;
            background: var(--button-dark); color: var(--accent-mint);
            border: 1px solid rgba(46, 125, 50, 0.5);
        }

        button:active { transform: scale(0.96); background: var(--primary-green); color: white; }

        input[type="text"] {
            width: 100%; padding: 20px; border-radius: 20px; border: 2px solid var(--primary-green);
            background: var(--button-dark); color: var(--white); font-size: 1.6rem;
            text-align: center; font-weight: bold; outline: none; margin-bottom: 12px;
        }

        .btn-portal { background: var(--primary-green); color: white; border: none; font-size: 1.2rem; }
        .btn-choice { font-size: 1.6rem; color: var(--white); }
        .btn-secondary { background: transparent; color: var(--accent-mint); opacity: 0.5; font-size: 0.8rem; border: 1px solid rgba(165,214,167,0.1); margin-top: 15px; }

        #question-text { font-size: 3.2rem; margin: 10px 0; font-weight: 900; min-height: 140px; display: flex; flex-direction: column; align-items: center; justify-content: center; line-height: 1.2;}
        #feedback-area { font-size: 1.1rem; font-weight: bold; height: 40px; margin-bottom: 10px; color: var(--gold); }
        .stat-row { width: 100%; display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--accent-mint); margin-bottom: 15px; font-weight: bold; opacity: 0.8;}
    </style>
</head>
<body>

<div id="app">
    <div id="timer-container"><div id="timer-bar"></div></div>

    <div id="view-hub" class="view-section">
        <img src="logo.png" class="app-logo" onerror="this.style.display='none'">
        <h1>Neural Hub</h1>
        <p>Keep your edge.</p>
        <div class="v-list">
            <button class="btn-portal" onclick="showPortal('math')">üî¢ NUMBER LAB</button>
            <button class="btn-portal" onclick="showPortal('word')">üî† LINGO LEXICON</button>
            <button class="btn-portal" onclick="showPortal('logic')">üß© PATTERN PULSE</button>
        </div>
    </div>

    <div id="view-portal-menu" class="view-section hidden">
        <h1 id="portal-title">Exercise</h1>
        <p>Select training path</p>
        <div id="op-list" class="v-list"></div>
        <button class="btn-secondary" onclick="resetToHub()">‚Üê BACK</button>
    </div>

    <div id="view-type" class="view-section hidden">
        <h1>Pace</h1>
        <div class="v-list">
            <button style="background: var(--primary-green); color: white;" onclick="pickType('zen')">ZEN FLOW (Relaxed)</button>
            <button style="background: #3e2723; color: white;" onclick="pickType('blitz')">BLITZ PULSE (Timed)</button>
            <button class="btn-secondary" onclick="showPortal(currentPortal)">‚Üê BACK</button>
        </div>
    </div>

    <div id="view-diff" class="view-section hidden">
        <h1>Intensity</h1>
        <div class="v-list">
            <button onclick="startGame('easy')">SPROUT (Easy)</button>
            <button onclick="startGame('hard')">TIMBER (Hard)</button>
            <button style="background: #000; color: #ff5252; border: 1px solid #ff5252;" onclick="startGame('god')">OVERGROWTH (God)</button>
            <button class="btn-secondary" onclick="pickType(selectedType)">‚Üê BACK</button>
        </div>
    </div>

    <div id="view-game" class="view-section hidden">
        <div class="stat-row">
            <span>Q: <span id="q-count">1</span>/10</span>
            <span id="score-count">SCORE: 0</span>
        </div>
        <div id="question-text">--</div>
        <div id="feedback-area"></div>
        
        <div id="input-container" class="v-list">
            <div id="choices-area" class="v-list"></div>
            <div id="text-area" class="hidden">
                <input type="text" id="answer-input" placeholder="..." autocomplete="off" spellcheck="false">
                <button class="btn-portal" onclick="submitTextAnswer()">SUBMIT</button>
            </div>
        </div>
        <button class="btn-secondary" onclick="resetToHub()">QUIT GAME</button>
    </div>

    <div id="view-results" class="view-section hidden">
        <h1>Session Over</h1>
        <p style="font-size: 4rem; margin: 20px 0; color: white;"><span id="final-score">0</span>/10</p>
        <button class="btn-portal" onclick="resetToHub()">BACK TO HUB</button>
    </div>
</div>

<script>
    let currentPortal = '', selectedOp = '', selectedType = '', selectedDiff = '';
    let currentScore = 0, questionNumber = 0, correctAnswer = '', timerInterval, timeLeft, maxTime;

    const words = [
        "ACTIVE", "ADVICE", "ANIMAL", "ANSWER", "APPLE", "AROUND", "BASKET", "BEAUTY", "BEFORE", "BETTER", "BOTTLE", "BRIDGE", "BRIGHT", "BROKEN", "BUTTON", "CAMERA", "CANCER", "CANDLE", "CENTER", "CHANCE", "CHANGE", "CHURCH", "CIRCLE", "COFFEE", "COLUMN", "COMMON", "CORNER", "COTTON", "COUPLE", "COURSE", "DANGER", "DARKER", "DECIDE", "DEGREE", "DESIGN", "DESIRE", "DETAIL", "DEVICE", "DINNER", "DOCTOR", "DOLLAR", "DOUBLE", "DURING", "EITHER", "ENERGY", "ENGINE", "ENOUGH", "EXCEPT", "EXPECT", "EXPERT", "FAMILY", "FATHER", "FELLOW", "FIGURE", "FINGER", "FINISH", "FLOWER", "FOLLOW", "FOREST", "FORGET", "FORMER", "FRIEND", "GARDEN", "GENTLE", "GROUND", "HAPPEN", "HEALTH", "HEAVEN", "HEIGHT", "HIDDEN", "HOCKEY", "HOLDER", "HOLLOW", "HUNTER", "IGNORE", "IMPACT", "IMPORT", "INCOME", "INDOOR", "INJURY", "INSIDE", "INTENT", "ISLAND", "ITSELF", "JACKET", "JERSEY", "JORDAN", "JOURNEY", "JOYFUL", "JUDGED", "JUNGLE", "KEEPER", "KETTLE", "KICKER", "KIDNEY", "KINDLY", "KNIGHT", "LADDER", "LANDED", "LATELY", "LATEST", "LAUGHED", "LAUNCH", "LEADER", "LEAGUE", "LEARNED", "LEGEND", "LETTER", "LIGHTER", "LIKELY", "LISTEN", "LITTLE", "LIVING", "LOVELY", "LUMBER", "MAGNET", "MAKING", "MANNER", "MARKET", "MASTER", "MATTER", "MEMORY", "MENTAL", "METHOD", "MIDDLE", "MINUTE", "MIRROR", "MOBILE", "MODERN", "MOMENT", "MONKEY", "MOTHER", "MOUNTAIN", "MOVING", "MUSEUM", "MYSELF", "NARROW", "NATIVE", "NATURE", "NEARLY", "NEPHEW", "NERVOUS", "NETWORK", "NEUTRAL", "NEWEST", "NICKEL", "NIGHTS", "NOTICE", "NUMBER", "OBJECT", "OFFICE", "OFFSET", "ONLINE", "OPTION", "ORANGE", "ORDERS", "OTHERS", "OUTPUT", "OXFORD", "OXYGEN", "PACKET", "PALACE", "PARENT", "PARKED", "PARTLY", "PATENT", "PEOPLE", "PERIOD", "PERMIT", "PHRASE", "PICKED", "PILLOW", "PLANET", "PLAYER", "PLEASE", "POCKET", "POLICE", "POLICY", "POWDER", "PRAYER", "PREFER", "PRETTY", "PRINCE", "PRISON", "PROFIT", "PROPER", "PUBLIC", "PUZZLE", "QUARTZ", "QUEBEC", "QUICKLY", "QUIETLY", "QUIVER", "RABBIT", "RATHER", "READER", "REASON", "RECENT", "RECORD", "REGION", "REJECT", "REMAIN", "REMOTE", "REPORT", "RESCUE", "RESULT", "RETAIL", "RETAIN", "RETURN", "REVEAL", "REVIEW", "REWARD", "RHYTHM", "RIBBON", "RIDING", "RISING", "RITUAL", "ROBOTS", "ROCKET", "RUBBER", "RUGGED", "RUNNER", "SAFETY", "SALARY", "SAMPLE", "SAVING", "SCENES", "SCHOOL", "SCREEN", "SEARCH", "SEASON", "SECOND", "SECRET", "SECTOR", "SELECT", "SELLER", "SENIOR", "SERIES", "SETTLE", "SEVERE", "SHADOW", "SHARED", "SHARPEN", "SHEEPS", "SHELVE", "SHERIF", "SHIELD", "SHORTS", "SHOULD", "SIGNAL", "SILENT", "SILVER", "SIMPLY", "SINGLE", "SISTER", "SLEEPY", "SLIGHT", "SLOWLY", "SMILED", "SMOOTH", "SOCIAL", "SOFTLY", "SOLVED", "SOURCE", "SPIRIT", "SPOKEN", "SPREAD", "SPRING", "SQUARE", "STABLE", "STAGES", "STAIRS", "STANDS", "STATED", "STATIC", "STATUS", "STAYED", "STEADY", "STOLEN", "STREAK", "STREAM", "STREET", "STRESS", "STRICT", "STRONG", "STUDIO", "SUBMIT", "SUDDEN", "SUFFER", "SUMMER", "SUMMIT", "SUPPLY", "SURELY", "SURVEY", "SWITCH", "SYMBOL", "SYSTEM", "TABLES", "TALENT", "TARGET", "TAUGHT", "TENANT", "TENDER", "THANKS", "THEORY", "THINGS", "THOUGHT", "THREAD", "THREAT", "THRILL", "THROUGH", "TICKET", "TIMELY", "TIMING", "TOWARD", "TRAVEL", "TREATY", "TRENCH", "TRIBAL", "TRICKS", "TROPHY", "TRUSTS", "TWELVE", "TWENTY", "TYPING", "UNIQUE", "UNITED", "UNLESS", "UPDATE", "UPHOLD", "UPON", "UPWARD", "URGENT", "USAGES", "USEFUL", "VACANT", "VALLEY", "VALUES", "VARIED", "VECTOR", "VELVET", "VESSEL", "VICTOR", "VIEWED", "VIRTUE", "VISION", "VISUAL", "VOICES", "VOLUME", "WALKER", "WALLET", "WANTED", "WARNER", "WASTED", "WATERS", "WEALTH", "WEEKLY", "WEIGHT", "WHOLLY", "WINDOW", "WINNER", "WINTER", "WIZARD", "WORKER", "WRIGHT", "WRITER", "YELLOW", "YOUNGER", "ZEPHYR", "ZIGZAG", "ZODIAC"
    ];

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(f, t, d) {
        const o = audioCtx.createOscillator(); const g = audioCtx.createGain();
        o.connect(g); g.connect(audioCtx.destination); o.type = t; o.frequency.value = f;
        g.gain.setValueAtTime(0.1, audioCtx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + d);
        o.start(); o.stop(audioCtx.currentTime + d);
    }

    function resetToHub() {
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-hub').classList.remove('hidden');
        document.getElementById('app').className = '';
        document.getElementById('timer-container').style.display = 'none';
        clearInterval(timerInterval);
    }

    function showPortal(p) {
        currentPortal = p;
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-portal-menu').classList.remove('hidden');
        const list = document.getElementById('op-list'); list.innerHTML = '';
        const ops = p === 'math' ? ["Add +", "Sub -", "Mul √ó", "Mixed ¬±√ó"] : p === 'word' ? ["Scramble", "Missing Letter"] : ["Logic Sequence"];
        ops.forEach(o => {
            const b = document.createElement('button'); b.innerText = o.toUpperCase();
            b.onclick = () => { selectedOp = o; showType(); }; list.appendChild(b);
        });
    }

    function showType() {
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-type').classList.remove('hidden');
    }

    function pickType(t) {
        selectedType = t;
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-diff').classList.remove('hidden');
    }

    function startGame(d) {
        selectedDiff = d; currentScore = 0; questionNumber = 1;
        maxTime = d === 'god' ? 4 : d === 'hard' ? 8 : 15;
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-game').classList.remove('hidden');
        if(selectedType === 'blitz') document.getElementById('timer-container').style.display = 'block';
        nextQuestion();
    }

    function nextQuestion() {
        if (questionNumber > 10) return showResults();
        
        document.getElementById('app').className = '';
        document.getElementById('feedback-area').innerText = '';
        document.getElementById('q-count').innerText = questionNumber;
        document.getElementById('score-count').innerText = `SCORE: ${currentScore}`;
        document.getElementById('answer-input').value = '';
        document.getElementById('text-area').classList.add('hidden');
        document.getElementById('choices-area').classList.remove('hidden');

        if (currentPortal === 'math') generateMath();
        else if (currentPortal === 'word') generateWord();
        else generateLogic();

        if (selectedType === 'blitz') startTimer();
    }

    function generateMath() {
        let range = selectedDiff === 'god' ? 999 : 100;
        let op = selectedOp.toLowerCase(); if(op.includes('mixed')) op = ['add','sub','mul'][Math.floor(Math.random()*3)];
        let n1, n2, sym;
        if(op.includes('add')){ n1=rand(range); n2=rand(range); correctAnswer = n1+n2; sym='+'; }
        else if(op.includes('sub')){ n1=rand(range)+10; n2=rand(n1); correctAnswer = n1-n2; sym='-'; }
        else { n1=rand(selectedDiff==='god'?40:12)+1; n2=rand(12)+1; correctAnswer = n1*n2; sym='√ó'; }
        document.getElementById('question-text').innerText = `${n1} ${sym} ${n2}`;
        makeChoices(correctAnswer);
    }

    function generateWord() {
        document.getElementById('choices-area').classList.add('hidden');
        document.getElementById('text-area').classList.remove('hidden');
        let w = words[Math.floor(Math.random()*words.length)]; correctAnswer = w;
        if(selectedOp.includes('Scramble')) {
            let s = w.split('').sort(()=>Math.random()-0.5).join('');
            document.getElementById('question-text').innerText = s;
        } else {
            let i = Math.floor(Math.random()*w.length);
            let d = w.split(''); d[i] = '_';
            document.getElementById('question-text').innerText = d.join('');
        }
        document.getElementById('answer-input').focus();
    }

    function generateLogic() {
        let seq = [], r = rand(3), s = rand(10)+1;
        if(r === 0) { let st = rand(8)+2; for(let i=0; i<4; i++) seq.push(s+(st*i)); correctAnswer = s+(st*4); }
        else if(r === 1) { seq = [s, s+rand(3)+1]; for(let i=2; i<4; i++) seq.push(seq[i-1]+seq[i-2]); correctAnswer = seq[3]+seq[2]; }
        else { let st = rand(4)+1; for(let i=0; i<4; i++) seq.push((st+i)*(st+i)); correctAnswer = (st+4)*(st+4); }
        document.getElementById('question-text').style.fontSize = "2.2rem";
        document.getElementById('question-text').innerText = seq.join(', ') + ', ?';
        makeChoices(correctAnswer);
    }

    function makeChoices(c) {
        let s = new Set([c]);
        while(s.size < 4) { let f = c + (Math.floor(Math.random()*10)-5); if(f>=0 && f!=c) s.add(f); }
        const area = document.getElementById('choices-area'); area.innerHTML = '';
        Array.from(s).sort(()=>Math.random()-0.5).forEach(v => {
            const b = document.createElement('button'); b.className = 'btn-choice'; b.innerText = v;
            b.onclick = () => check(v, b); area.appendChild(b);
        });
    }

    function submitTextAnswer() { check(document.getElementById('answer-input').value.toUpperCase().trim()); }

    function check(v, btn) {
        clearInterval(timerInterval);
        document.querySelectorAll('.btn-choice').forEach(b => b.disabled = true);
        const app = document.getElementById('app');
        
        if(String(v) === String(correctAnswer)) {
            currentScore++; app.classList.add('flash-right');
            playSound(600, 'sine', 0.1); playSound(800, 'sine', 0.1);
            document.getElementById('feedback-area').innerText = "EXCELLENT! +1";
        } else {
            app.classList.add('flash-wrong', 'shake');
            playSound(100, 'square', 0.3);
            document.querySelectorAll('.btn-choice').forEach(b => { if(b.innerText == correctAnswer) b.style.backgroundColor = "var(--primary-green)"; });
            document.getElementById('feedback-area').innerText = "WRONG! IT WAS: " + correctAnswer;
        }
        setTimeout(() => app.classList.remove('shake'), 400);
        questionNumber++; setTimeout(nextQuestion, 1800);
    }

    function startTimer() {
        clearInterval(timerInterval); timeLeft = maxTime;
        const bar = document.getElementById('timer-bar');
        timerInterval = setInterval(() => {
            timeLeft -= 0.05; bar.style.width = (timeLeft/maxTime)*100 + "%";
            if(timeLeft <= 0) { clearInterval(timerInterval); check('TIMEOUT'); }
        }, 50);
    }

    function showResults() {
        document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
        document.getElementById('view-results').classList.remove('hidden');
        document.getElementById('final-score').innerText = currentScore;
    }

    function rand(m) { return Math.floor(Math.random()*m); }
    document.getElementById('answer-input').addEventListener('keypress', (e) => { if(e.key === 'Enter') submitTextAnswer(); });
</script>
</body>
</html>
